# –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ HR Platform –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö multi-device –∏ multi-role –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –ø–æ–∑–≤–æ–ª—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª—è—Ö –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. Access Token - Stateless JWT

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ö–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–π —Ç–æ–∫–µ–Ω (15-30 –º–∏–Ω—É—Ç)
- Stateless - –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î
- –°–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: `userId`, `roleContextId`, `userRoleName`
- –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ —á–µ—Ä–µ–∑ JWT Strategy

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ JWT Payload:**
```typescript
{
  sub: string,           // userId
  roleContextId: string, // ID –∞–∫—Ç–∏–≤–Ω–æ–≥–æ role context
  userRoleName: string,  // –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ä–æ–ª–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã user_roles (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UserRoleName enum –¥–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö)
  companyId: string | null, // ID –∫–æ–º–ø–∞–Ω–∏–∏ (–¥–ª—è EMPLOYER —Ä–æ–ª–∏ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  hrRoleName: string | null, // –ù–∞–∑–≤–∞–Ω–∏–µ HR —Ä–æ–ª–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã hr_roles (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HrRoleName enum –¥–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö, —Ç–æ–ª—å–∫–æ –¥–ª—è EMPLOYER)
  iat: number,           // issued at
  exp: number            // expiration
}
```

**–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π:**

1. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–æ–ª–∏** (`userRoleName` - –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `user_roles`):
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ (enum `UserRoleName`):
     - `CANDIDATE` - —Å–æ–∏—Å–∫–∞—Ç–µ–ª—å
     - `EMPLOYER` - —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å (–≤–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ –∏–ª–∏ HR —Å–æ—Ç—Ä—É–¥–Ω–∏–∫)
     - `ADMIN` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã
   - –†–∞—Å—à–∏—Ä—è–µ–º–æ —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É `user_roles` (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–æ–ª–∏ –≤ –ë–î)
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ seed –¥–∞–Ω–Ω—ã–µ

2. **HR —Ä–æ–ª–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–∞–Ω–∏–∏** (`hrRoleName` - –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `hr_roles`):
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ (enum `HrRoleName`):
     - `HR` - –æ–±—ã—á–Ω—ã–π HR —Å–æ—Ç—Ä—É–¥–Ω–∏–∫
     - `HR_ADMIN` - HR –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö HR)
   - –†–∞—Å—à–∏—Ä—è–µ–º–æ —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É `hr_roles` (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å HR_RECRUITER, HR_ANALYST –∏ —Ç.–¥. –≤ –ë–î)
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ seed –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏–Ω—Ü–∏–ø:**
- –í–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ EMPLOYER —Å `hrRoleName: HR_ADMIN`
- –í—Å–µ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ EMPLOYER —Ä–æ–ª—å
- –†–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `user_roles` –∏ `hr_roles` –¥–ª—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏
- –î–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è enum'—ã (`UserRoleName`, `HrRoleName`) –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ë–î (—Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ seed)

### 2. Refresh Token - Stateful

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–π —Ç–æ–∫–µ–Ω (7-30 –¥–Ω–µ–π)
- Stateful - —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
- –ü—Ä–∏–≤—è–∑–∞–Ω –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É (`deviceId`)
- –ü—Ä–∏–≤—è–∑–∞–Ω –∫ role context (`roleContextId`)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ access token

**–ü—Ä–∏–Ω—Ü–∏–ø —Ö—Ä–∞–Ω–µ–Ω–∏—è:**
```
Refresh Token = (userId + roleContextId + deviceId)
```

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (bcrypt/argon2)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ hash comparison
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ cron

### 3. Multi-Device –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

1. **–û–¥–∏–Ω device = –æ–¥–∏–Ω refresh token = –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π role context**
   - –ö–∞–∂–¥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é
   - –ü—Ä–∏ —Å–º–µ–Ω–µ —Ä–æ–ª–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ - —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è, —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π

2. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤**
   - Login –Ω–∞ –Ω–æ–≤–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –Ω–µ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–µ
   - Logout –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ
   - –ö–∞–∂–¥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∂–∏–≤—ë—Ç —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é

3. **–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è:**
   ```
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å user@example.com:

   üì± –¢–µ–ª–µ—Ñ–æ–Ω: (U1, CANDIDATE, PHONE) - –∞–∫—Ç–∏–≤–µ–Ω
   üíª –ö–æ–º–ø—å—é—Ç–µ—Ä: (U1, HR, PC) - –∞–∫—Ç–∏–≤–µ–Ω

   –û–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
   ```

### 4. Multi-Role –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

1. **–û–¥–∏–Ω email = –Ω–µ—Å–∫–æ–ª—å–∫–æ Role Context**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ CANDIDATE
   - –ò –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∫–∞–∫ EMPLOYER (–≤–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏)
   - –ö–∞–∂–¥–∞—è —Ä–æ–ª—å –∏–º–µ–µ—Ç —Å–≤–æ–π RoleContext

2. **Role Context –≤ —Å–µ—Å—Å–∏–∏**
   - –í —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ä–æ–ª—å
   - JWT –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç `roleContextId` –∏ `roleType`
   - Guards –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –¥–æ—Å—Ç—É–ø –Ω–∞ –æ—Å–Ω–æ–≤–µ role context

3. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–∏**
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–æ–≤—ã–π login —Å –≤—ã–±–æ—Ä–æ–º —Ä–æ–ª–∏
   - –°—Ç–∞—Ä—ã–π refresh token –¥–ª—è —ç—Ç–æ–≥–æ device —É–¥–∞–ª—è–µ—Ç—Å—è
   - –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π refresh token —Å –Ω–æ–≤—ã–º role context

### 5. Sliding Session

**–ü—Ä–∏–Ω—Ü–∏–ø:**
- Access token –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ª—é–±–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º access token –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ä–µ–º—è –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- –ï—Å–ª–∏ –æ—Å—Ç–∞–ª–æ—Å—å < 50% –≤—Ä–µ–º–µ–Ω–∏ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π access token
- Refresh token —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å—Å—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ß–µ—Ä–µ–∑ Interceptor –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- –ü—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
- –£–ª—É—á—à–∞–µ—Ç UX (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç –ø—Ä–æ–¥–ª–µ–Ω–∏—è)

### 6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤

**Cron –∑–∞–¥–∞—á–∞:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö refresh —Ç–æ–∫–µ–Ω–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≥–¥–µ `expiresAt < NOW()`
- Hard delete (—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)
- –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ –≤ –ë–î

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### User

–ë–∞–∑–æ–≤–∞—è —Å—É—â–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**–ü–æ–ª—è:**
- `id` - UUID
- `email` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π email
- `password` - —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å
- `isActivated` - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ª–∏ email
- `activationLink` - —Å—Å—ã–ª–∫–∞ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- `createdAt`, `updatedAt`

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- –û–¥–∏–Ω email –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- Email –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Ö–æ–¥–∞
- –ü–∞—Ä–æ–ª—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (bcrypt/argon2)

### RoleContext

–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ. –û–¥–∏–Ω User –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ RoleContext.

**–ü–æ–ª—è:**
- `id` - UUID
- `userId` - —Å–≤—è–∑—å —Å User
- `type` - –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–∏–ø —Ä–æ–ª–∏: `CANDIDATE | EMPLOYER | ADMIN`
- `companyId` - –¥–ª—è EMPLOYER —Ä–æ–ª–∏ - –∫–æ–º–ø–∞–Ω–∏—è, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–≤—è–∑–∞–Ω —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è EMPLOYER)
- `hrRoleName` - –¥–ª—è EMPLOYER —Ä–æ–ª–∏: `HR | HR_ADMIN` (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã hr_roles, HR_ADMIN –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö HR, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ)
- `createdAt`

**–¢–∏–ø—ã —Ä–æ–ª–µ–π (–≥–ª–æ–±–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å):**

1. **CANDIDATE**
   - –°–æ–∏—Å–∫–∞—Ç–µ–ª—å
   - –°–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç
   - –°–≤—è–∑–∞–Ω —Å CandidateProfile
   - –ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–º–ø–∞–Ω–∏–∏

2. **EMPLOYER**
   - –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å (–≤–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ –∏–ª–∏ HR —Å–æ—Ç—Ä—É–¥–Ω–∏–∫)
   - –í—Å–µ–≥–¥–∞ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ `companyId` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ EMPLOYER –≤ –æ–¥–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
   - –í–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ EMPLOYER —Å `hrRoleName: HR_ADMIN` (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã hr_roles)
   - –¢–∏–ø—ã —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è (—É—Ä–æ–≤–µ–Ω—å –≤–Ω—É—Ç—Ä–∏ EMPLOYER):
     - **HR** - –æ–±—ã—á–Ω—ã–π HR —Å–æ—Ç—Ä—É–¥–Ω–∏–∫
     - **HR_ADMIN** - HR –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö HR –≤ –∫–æ–º–ø–∞–Ω–∏—é
     - –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å: HR_RECRUITER, HR_ANALYST –∏ —Ç.–¥.

3. **ADMIN**
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã
   - –°–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä—É—á–Ω—É—é
   - –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ä–µ—Å—É—Ä—Å–∞–º
   - –ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–º–ø–∞–Ω–∏–∏

**–í–∞–∂–Ω–æ:**
- –í–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ = EMPLOYER —Å `hrRoleName: HR_ADMIN` (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã hr_roles)
- –í—Å–µ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ EMPLOYER —Ä–æ–ª—å

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- –û–¥–∏–Ω User –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ RoleContext
- –í —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ –∞–∫—Ç–∏–≤–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω RoleContext
- RoleContext –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º —á–µ—Ä–µ–∑ Guards

### Company

–ö–æ–º–ø–∞–Ω–∏—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è. –°–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è.

**–ü–æ–ª—è:**
- `id` - UUID
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `inn` - –ò–ù–ù (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `companyTypeId` - —Å–≤—è–∑—å —Å `company_types` (–ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏)
- `ownerId` - User, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–ª –∫–æ–º–ø–∞–Ω–∏—é (EMPLOYER —Å HR_ADMIN role)
- `createdAt`, `updatedAt`

**–°–≤—è–∑—å —Å CompanyType:**
- –¢–∏–ø—ã –∫–æ–º–ø–∞–Ω–∏–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `company_types`
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã
- –¢–∏–ø—ã: ORGANIZATION, IP, LAWYER, SELF_EMPLOYED, OTHER

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –≤–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ EMPLOYER —Å `hrRoleName: HR_ADMIN` (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã hr_roles)
- –í–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ = EMPLOYER —Å –ø—Ä–∞–≤–∞–º–∏ HR_ADMIN
- –ö–æ–º–ø–∞–Ω–∏—è –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ HR —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- –°–≤—è–∑–∞–Ω–∞ —Å CompanyType —á–µ—Ä–µ–∑ `company_type_id`

### Token

–•—Ä–∞–Ω–∏–ª–∏—â–µ refresh —Ç–æ–∫–µ–Ω–æ–≤. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å = –æ–¥–Ω–∞ —Å–µ—Å—Å–∏—è –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.

**–ü–æ–ª—è:**
- `id` - UUID
- `userId` - —Å–≤—è–∑—å —Å User
- `roleContextId` - –∞–∫—Ç–∏–≤–Ω—ã–π role context –¥–ª—è —ç—Ç–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- `refreshToken` - —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π refresh token
- `deviceId` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `deviceName` - –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `userAgent` - user agent –±—Ä–∞—É–∑–µ—Ä–∞
- `ipAddress` - IP –∞–¥—Ä–µ—Å
- `expiresAt` - —Å—Ä–æ–∫ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- `createdAt`, `updatedAt`

**Unique constraint:**
```
(userId, roleContextId, deviceId) - —É–Ω–∏–∫–∞–ª—å–Ω–æ
```

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- Refresh token —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
- –û–¥–∏–Ω device –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π refresh token
- –ü—Ä–∏ —Å–º–µ–Ω–µ —Ä–æ–ª–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ - —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è
- Logout –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —É–¥–∞–ª—è–µ—Ç –æ–¥–Ω—É –∑–∞–ø–∏—Å—å
- Logout –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ü–æ—Ç–æ–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `RegisterCandidateDto` (email, password, fio)
2. –°–æ–∑–¥–∞—ë—Ç—Å—è User
3. –°–æ–∑–¥–∞—ë—Ç—Å—è RoleContext (type: CANDIDATE)
4. –°–æ–∑–¥–∞—ë—Ç—Å—è CandidateProfile
5. –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è access + refresh —Ç–æ–∫–µ–Ω—ã
6. Refresh —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Token —Ç–∞–±–ª–∏—Ü–µ
7. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è access token –∏ refresh token

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è (—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `RegisterEmployerDto` (email, password, companyName, inn, companyTypeId)
2. –°–æ–∑–¥–∞—ë—Ç—Å—è User
3. –°–æ–∑–¥–∞—ë—Ç—Å—è Company (—Å companyTypeId –∏–∑ —Ç–∞–±–ª–∏—Ü—ã company_types)
4. –ü–æ–ª—É—á–∞–µ—Ç—Å—è UserRole (EMPLOYER) –∏ HrRole (HR_ADMIN) –∏–∑ —Ç–∞–±–ª–∏—Ü, —Å–æ–∑–¥–∞—ë—Ç—Å—è RoleContext (userRoleId, companyId, hrRoleId: HR_ADMIN)
   - –í–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏ = EMPLOYER —Å –ø—Ä–∞–≤–∞–º–∏ HR_ADMIN
5. EmployerProfile –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è - –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ Company
6. –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ç–æ–∫–µ–Ω—ã
7. –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–∫–µ–Ω—ã

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `companies`, –∞ –Ω–µ –≤ `employer_profiles`

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è HR –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–º–ø–∞–Ω–∏—é

1. HR-ADMIN –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `RegisterHrDto` (email, password, companyId, hrRoleName)
2. –°–æ–∑–¥–∞—ë—Ç—Å—è User
3. –ü–æ–ª—É—á–∞–µ—Ç—Å—è UserRole (EMPLOYER) –∏ HrRole (HR –∏–ª–∏ HR_ADMIN) –∏–∑ —Ç–∞–±–ª–∏—Ü, —Å–æ–∑–¥–∞—ë—Ç—Å—è RoleContext (userRoleId, companyId, hrRoleId)
4. –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ç–æ–∫–µ–Ω—ã
5. –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–∫–µ–Ω—ã

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢–æ–ª—å–∫–æ HR_ADMIN –º–æ–∂–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã—Ö EMPLOYER (HR) –≤ –∫–æ–º–ø–∞–Ω–∏—é.

### Login

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email –∏ password
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è User (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å)
3. –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–æ RoleContext - —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–±–æ—Ä —Ä–æ–ª–∏
4. –°–æ–∑–¥–∞—ë—Ç—Å—è refresh —Ç–æ–∫–µ–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ deviceId
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è unique constraint (userId, roleContextId, deviceId)
   - –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —É–¥–∞–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π, —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π
6. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è access token
7. –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–∫–µ–Ω—ã

### Refresh

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç refresh token
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –≤ Token —Ç–∞–±–ª–∏—Ü–µ
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (expiresAt)
4. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è hash refresh token
5. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π access token
6. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è expiresAt (sliding session)
7. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π access token

### Logout –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ logout
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è deviceId –∏–∑ refresh token –∏–ª–∏ request
3. –£–¥–∞–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –∏–∑ Token —Ç–∞–±–ª–∏—Ü—ã (userId, roleContextId, deviceId)
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

### Logout —Å–æ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ logout-all
2. –£–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ Token —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è userId
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

**Access Token:**
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–µ –≤ localStorage)
- –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`
- HttpOnly cookies (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã)

**Refresh Token:**
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ HttpOnly cookie (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- –ò–ª–∏ –≤ secure storage (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ URL

### –í–∞–ª–∏–¥–∞—Ü–∏—è

**Access Token:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ JWT
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã payload

**Refresh Token:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤ –ë–î
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ hash
- –ü—Ä–æ–≤–µ—Ä–∫–∞ deviceId (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã)

### –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

1. **Brute Force**
   - Rate limiting –Ω–∞ endpoints –≤—Ö–æ–¥–∞
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Å–ª–µ N –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

2. **Token Theft**
   - Refresh token –ø—Ä–∏–≤—è–∑–∞–Ω –∫ deviceId
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ IP –∞–¥—Ä–µ—Å–æ–≤
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

3. **Session Fixation**
   - –ù–æ–≤—ã–π refresh token –ø—Ä–∏ –∫–∞–∂–¥–æ–º login
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–æ–ª–∏

4. **XSS/CSRF**
   - HttpOnly cookies –¥–ª—è refresh token
   - CSRF tokens –¥–ª—è state-changing –æ–ø–µ—Ä–∞—Ü–∏–π

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π

### Guards

Guards –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –¥–æ—Å—Ç—É–ø –∫ –º–∞—Ä—à—Ä—É—Ç–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ role context:

- `@UseGuards(JwtAuthGuard)` - —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π access token
- `@UseGuards(JwtAuthGuard, RolesGuard)` - —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π token + –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Ä–æ–ª—å
- `@Roles('EMPLOYER')` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –ø–æ —Ä–æ–ª—è–º

### Decorators

–£–ø—Ä–æ—â–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

- `@CurrentUser()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç User entity
- `@CurrentRole()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç RoleContext entity
- `@Roles(...)` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è RolesGuard

### Interceptors

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ access token:

- `TokenRefreshInterceptor` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π access token –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

## Cron –∑–∞–¥–∞—á–∏

### –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00 AM

**–õ–æ–≥–∏–∫–∞:**
```typescript
DELETE FROM tokens WHERE expires_at < NOW()
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- Hard delete (—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)
- –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ –≤ –ë–î
- –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: Multi-device, –æ–¥–Ω–∞ —Ä–æ–ª—å

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å user@example.com (CANDIDATE):

üì± –¢–µ–ª–µ—Ñ–æ–Ω: login ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è (U1, CANDIDATE, PHONE)
üíª –ö–æ–º–ø—å—é—Ç–µ—Ä: login ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è (U1, CANDIDATE, PC)

–û–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
Logout –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä.
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: Multi-device, —Ä–∞–∑–Ω—ã–µ —Ä–æ–ª–∏

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å user@example.com:

üì± –¢–µ–ª–µ—Ñ–æ–Ω: login as CANDIDATE ‚Üí (U1, CANDIDATE, PHONE)
üíª –ö–æ–º–ø—å—é—Ç–µ—Ä: login as EMPLOYER ‚Üí (U1, EMPLOYER, PC)

–û–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
–ù–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ - —Ä–æ–ª—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞, –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ - EMPLOYER (–≤–ª–∞–¥–µ–ª–µ—Ü –∫–æ–º–ø–∞–Ω–∏–∏).
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–º–µ–Ω–∞ —Ä–æ–ª–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å user@example.com:

üíª –ö–æ–º–ø—å—é—Ç–µ—Ä: login as CANDIDATE ‚Üí (U1, CANDIDATE, PC)
üíª –ö–æ–º–ø—å—é—Ç–µ—Ä: logout
üíª –ö–æ–º–ø—å—é—Ç–µ—Ä: login as EMPLOYER ‚Üí (U1, EMPLOYER, PC)

–°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω (CANDIDATE) —É–¥–∞–ª—è–µ—Ç—Å—è.
–°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω (EMPLOYER).
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: HR –≤ –∫–æ–º–ø–∞–Ω–∏–∏

```
–í–ª–∞–¥–µ–ª–µ—Ü —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º–ø–∞–Ω–∏—é:
- –°–æ–∑–¥–∞—ë—Ç—Å—è Company (companyTypeId –∏–∑ company_types)
- –ü–æ–ª—É—á–∞–µ—Ç—Å—è UserRole (EMPLOYER) –∏ HrRole (HR_ADMIN) –∏–∑ —Ç–∞–±–ª–∏—Ü, —Å–æ–∑–¥–∞—ë—Ç—Å—è RoleContext (userRoleId, companyId, hrRoleId: HR_ADMIN)
- –í–ª–∞–¥–µ–ª–µ—Ü = EMPLOYER —Å –ø—Ä–∞–≤–∞–º–∏ HR_ADMIN

HR-ADMIN –¥–æ–±–∞–≤–ª—è–µ—Ç HR —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:
- –°–æ–∑–¥–∞—ë—Ç—Å—è User –¥–ª—è HR
- –ü–æ–ª—É—á–∞–µ—Ç—Å—è UserRole (EMPLOYER) –∏ HrRole (HR –∏–ª–∏ HR_ADMIN) –∏–∑ —Ç–∞–±–ª–∏—Ü, —Å–æ–∑–¥–∞—ë—Ç—Å—è RoleContext (userRoleId, companyId, hrRoleId)

EMPLOYER –º–æ–∂–µ—Ç –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è —Å —Ä–æ–ª—å—é EMPLOYER –∏ –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –∫–æ–º–ø–∞–Ω–∏–∏.
HR_ADMIN –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö HR –≤ –∫–æ–º–ø–∞–Ω–∏—é.
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è HR –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–º–ø–∞–Ω–∏—é

```
HR-ADMIN —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ HR:
POST /auth/register/hr
{
  email: "hr@company.com",
  password: "Password123",
  companyId: "company-id",
  hrRoleName: "HR" // –∏–ª–∏ "HR_ADMIN" (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã hr_roles, –¥–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å HrRoleName.HR –∏–ª–∏ HrRoleName.HR_ADMIN)
}

–°–æ–∑–¥–∞—ë—Ç—Å—è:
- User
- RoleContext (userRoleId: EMPLOYER, companyId, hrRoleId: HR –∏–ª–∏ HR_ADMIN)
- –¢–æ–∫–µ–Ω—ã

HR –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –∫–æ–º–ø–∞–Ω–∏–∏.
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ HR Platform –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—É—é multi-device –ø–æ–¥–¥–µ—Ä–∂–∫—É
‚úÖ Multi-role –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏
‚úÖ –ó–∞—â–∏—Ç—É –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫
‚úÖ –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É —Ä–æ–ª–µ–π:
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: CANDIDATE | EMPLOYER | ADMIN
   - –í–Ω—É—Ç—Ä–∏ EMPLOYER: HR | HR_ADMIN (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ)
‚úÖ –¢–∏–ø—ã –∫–æ–º–ø–∞–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ)
‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—é —Ä–æ–ª–µ–π —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è (HR, HR_ADMIN)
‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é HR –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–º–ø–∞–Ω–∏—é (—Ç–æ–ª—å–∫–æ HR_ADMIN)
‚úÖ companyId –≤ JWT –¥–ª—è EMPLOYER —Ä–æ–ª–µ–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è EMPLOYER)
‚úÖ –ü—Ä–æ–µ–∫—Ç—ã –∫–æ–º–ø–∞–Ω–∏–π –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π (Company ‚Üí Project ‚Üí Vacancy)

–í—Å–µ –ø–æ—Ç–æ–∫–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
